{
  "hash": "f9c1acccb0080668e5abd46839dde0b0",
  "result": {
    "markdown": "---\ntitle: \"Estimating multifractal spectra with Chhabra-Jensen's method\"\ndescription: \"blog post description (appears underneath the title in smaller text) which is included on the listing page\"\nauthor:\n  - name: Lucas Fran√ßa\n    url: https://lfranca.uk\n    orcid: 0000-0003-0853-1319\n    affiliation: Assistant Professor in Computer and Information Sciences at Northumbria University\n    affiliation-url: https://researchportal.northumbria.ac.uk/en/persons/lucas-franca\ndate: 01-06-2020\ncategories: [Fractals]\ntags: [\"fractal\", \"multifractal\", \"chhabra-jensen\", \"tutorial\", \"how to\", \"time series\", \"Python\", \"Matlab\", \"script\"]\ncitation: \n  url: https://lfranca.uk/posts/multifractal-chj/ \nbibliography: ref.bib\nlink-citations: true\ndraft: false\n---\n\n\n\n\n\n\n## Multifractals\n\nOver the last decades fractal analyses have revolutionised many fields of science. Such metrics are relevant to fields ranging from economics to neuroscience. However, some objects cannot be accurately described with a single scaling factor --- fractal dimension --- $D$ and require an infinite number of values to be accurately described [@Stanley1999].\n\n## The multifractal spectrum\n\nThe multifractal spectum represents the Holder exponents and their Hausdorff dimensions for an object. Such spectra can be evaluated according to their geometric properties, mainly width ($\\Delta\\alpha$) and height ($\\Delta f$) [@Stanley1999; @Franca2018]. An example of multifractal spectrum and its geometric features can be seen in figure \\@ref(fig:spectrumPlot).\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![\\label Example of multifractal spectrum. The figure shows the two main measures, i.e. width ($\\Delta \\alpha$) and height ($\\Delta f$).](index_files/figure-html/spectrumPlot-1.png){width=720}\n:::\n:::\n\n\n## The Chhabra-Jensen method\n\nThere are several different algorithms that allow the obtention of multifractal spectra from time series. The most famous are the MF-DFA [@Gu2010], MF-DMA [@Kantelhardt2002], and Chhabra-Jensen [@Chhabra1989].\n\nThe @Chhabra1989 method, amongst other advantages, allows the direct obtention of the multifractal spectra without the use of a Legendre's transform [@Chhabra1989; @Biswas2012; @Franca2018; @Franca2019]. The spectra are obtained directly from the two parametric equations \\@ref(eq:alpha) and \\@ref(eq:falpha).\n\n\n```{=tex}\n\\begin{equation}\n\\alpha(q) = \\lim_{l\\rightarrow0}\\frac{\\sum_{i}{\\mu_{i}(q,l)\\log{P_{i}(l)}}}{\\log{l}}\n\\label{eq:alpha}\n\\end{equation}\n```\n\n```{=tex}\n\\begin{equation}\nf(q) = \\lim_{l\\rightarrow0}{\\frac{\\sum_{i}{\\mu_{i}(q,l)\\log{\\mu_{i}(q,l)}}}{\\log{l}}}\n\\label{eq:falpha}\n\\end{equation}\n```\n\n$$\\mu_{i}(q,l) = \\frac{P_{i}(l)^{q}}{\\sum_{j}P_{j}(l)^{q}}$$\n\n## Runing the script\n\nThe script used in @Franca2018 can be downloaded from my [Github repository](https://github.com/lucasfr/chhabra-jensen) and is currently available in Python and Matlab (if you would like to help the adaptation to other programming languages, please get in touch!). The script can be run as shown below:\n\n#### Python\n\n``` python\nimport chhabrajensen as chj\n\nalpha,falpha,Dq,Rsqr_alpha,Rsqr_falpha,Rsqr_Dq,muScale,Md,Ma,Mf = chj.getSpectrum(Timeseries,qValues,scales)\n```\n\n#### Matlab\n\n``` matlab\n\n[alpha,falpha,Dq,Rsqr_alpha,Rsqr_falpha,Rsqr_Dq,muScale,Md,Ma,Mf] = ChhabraJensen_Yuj_w0(Timeseries,qValues,scales)\n```\n\nINPUT:\n\nTimeseries, [qValues](#defining-q-range), and [scales](#defining-scales-range) are all row vectors.\n\n{{% alert warning %}} This function assumes that your time series is all positive values and none of the [qValues](#defining-q-range) can be between 0 and 1. {{% /alert %}}\n\nOUTPUT:\n\nalpha ($\\alpha$) and falpha ($f(\\alpha)$) scattered against each other give the multifractal spectrum. qValues ($q$) and Dq ($D_q$) scattered against each other give the generalised dimensions spectrum. Rsqr_alpha, Rsqr_falpha, and Rsqr_Dq are the $R^2$ values for each of the values in $\\alpha$, $f(\\alpha)$, and $D_q$ respectively.\n\n{{% alert warning %}} For the correct obtention of multifractal spectra it is important that both [qValues](#defining-q-range) and [scales](#defining-scales-range) are adequately defined. {{% /alert %}}\n\nmuScale ($\\log(l)$), Md, Ma, and Mf ($\\mu(q,l)$) are the basic matrices from which $\\alpha$, $f(\\alpha)$, and $D_q$ can be constructed by linear regression. They are included in the output mainly for completeness.\n\n## Defining scales range {#defining-scales-range}\n\nIt is essential to define the range of scales from which the multifractal spectra are obtained to avoid overfitting and inaccuracies in the curves. This can be done by studying the partition function curves and selecting adequate scales.\n\nOn a log-log plot, the curves should be linear and scales that do not follow such trend can be easily identified. Figure 2 shows an example of partition function and linear regime.\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div align=\"center\">\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-549a0cebe0f7c1e37e8e\" style=\"width:100%;height:400px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-549a0cebe0f7c1e37e8e\">{\"x\":{\"data\":[{\"x\":[-0.3010299956639812,-0.6020599913279624,-0.90308998699194354,-1.2041199826559248,-1.505149978319906,-1.8061799739838871,-2.1072099696478683,-2.4082399653118496,-2.7092699609758308],\"y\":[5.7852793896718513,10.747086889453492,18.518135001253007,25.124770683995624,33.565713206918993,42.507885192594628,50.119255306374129,56.618377603529687,68.741485793393423],\"text\":[\"muScales: -0.30103<br />value:   5.785279<br />q: q = -15\",\"muScales: -0.60206<br />value:  10.747087<br />q: q = -15\",\"muScales: -0.90309<br />value:  18.518135<br />q: q = -15\",\"muScales: -1.20412<br />value:  25.124771<br />q: q = -15\",\"muScales: -1.50515<br />value:  33.565713<br />q: q = -15\",\"muScales: -1.80618<br />value:  42.507885<br />q: q = -15\",\"muScales: -2.10721<br />value:  50.119255<br />q: q = -15\",\"muScales: -2.40824<br />value:  56.618378<br />q: q = -15\",\"muScales: -2.70927<br />value:  68.741486<br />q: q = -15\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(68,1,84,1)\",\"opacity\":1,\"size\":11.338582677165356,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(68,1,84,1)\"}},\"hoveron\":\"points\",\"name\":\"q = -15\",\"legendgroup\":\"q = -15\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[-0.3010299956639812,-0.6020599913279624,-0.90308998699194354,-1.2041199826559248,-1.505149978319906,-1.8061799739838871,-2.1072099696478683,-2.4082399653118496,-2.7092699609758308],\"y\":[3.8675026622715332,7.298224435751675,12.397384492468534,16.838959756452866,22.379881775149133,28.339684094235075,33.413222589263093,37.770676013696622,45.827658064054511],\"text\":[\"muScales: -0.30103<br />value:   3.867503<br />q: q = -10\",\"muScales: -0.60206<br />value:   7.298224<br />q: q = -10\",\"muScales: -0.90309<br />value:  12.397384<br />q: q = -10\",\"muScales: -1.20412<br />value:  16.838960<br />q: q = -10\",\"muScales: -1.50515<br />value:  22.379882<br />q: q = -10\",\"muScales: -1.80618<br />value:  28.339684<br />q: q = -10\",\"muScales: -2.10721<br />value:  33.413223<br />q: q = -10\",\"muScales: -2.40824<br />value:  37.770676<br />q: q = -10\",\"muScales: -2.70927<br />value:  45.827658<br />q: q = -10\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(70,52,128,1)\",\"opacity\":1,\"size\":11.338582677165356,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(70,52,128,1)\"}},\"hoveron\":\"points\",\"name\":\"q = -10\",\"legendgroup\":\"q = -10\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[-0.3010299956639812,-0.6020599913279624,-0.90308998699194354,-1.2041199826559248,-1.505149978319906,-1.8061799739838871,-2.1072099696478683,-2.4082399653118496,-2.7092699609758308],\"y\":[1.9949748390831155,3.8826307714643851,6.3772834951953552,8.6184271344022818,11.249837040078763,14.20080069610356,16.732644849605197,19.005231864733862,22.915129329754933],\"text\":[\"muScales: -0.30103<br />value:   1.994975<br />q: q = -5\",\"muScales: -0.60206<br />value:   3.882631<br />q: q = -5\",\"muScales: -0.90309<br />value:   6.377283<br />q: q = -5\",\"muScales: -1.20412<br />value:   8.618427<br />q: q = -5\",\"muScales: -1.50515<br />value:  11.249837<br />q: q = -5\",\"muScales: -1.80618<br />value:  14.200801<br />q: q = -5\",\"muScales: -2.10721<br />value:  16.732645<br />q: q = -5\",\"muScales: -2.40824<br />value:  19.005232<br />q: q = -5\",\"muScales: -2.70927<br />value:  22.915129<br />q: q = -5\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(53,96,141,1)\",\"opacity\":1,\"size\":11.338582677165356,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(53,96,141,1)\"}},\"hoveron\":\"points\",\"name\":\"q = -5\",\"legendgroup\":\"q = -5\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[-0.3010299956639812,-0.6020599913279624,-0.90308998699194354,-1.2041199826559248,-1.505149978319906,-1.8061799739838871,-2.1072099696478683,-2.4082399653118496,-2.7092699609758308],\"y\":[0.3010299956639812,0.6020599913279624,0.90308998699194354,1.2041199826559248,1.505149978319906,1.8061799739838871,2.1072099696478683,2.4082399653118496,2.7092699609758308],\"text\":[\"muScales: -0.30103<br />value:   0.301030<br />q: q = 0\",\"muScales: -0.60206<br />value:   0.602060<br />q: q = 0\",\"muScales: -0.90309<br />value:   0.903090<br />q: q = 0\",\"muScales: -1.20412<br />value:   1.204120<br />q: q = 0\",\"muScales: -1.50515<br />value:   1.505150<br />q: q = 0\",\"muScales: -1.80618<br />value:   1.806180<br />q: q = 0\",\"muScales: -2.10721<br />value:   2.107210<br />q: q = 0\",\"muScales: -2.40824<br />value:   2.408240<br />q: q = 0\",\"muScales: -2.70927<br />value:   2.709270<br />q: q = 0\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(37,132,142,1)\",\"opacity\":1,\"size\":11.338582677165356,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(37,132,142,1)\"}},\"hoveron\":\"points\",\"name\":\"q = 0\",\"legendgroup\":\"q = 0\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[-0.3010299956639812,-0.6020599913279624,-0.90308998699194354,-1.2041199826559248,-1.505149978319906,-1.8061799739838871,-2.1072099696478683,-2.4082399653118496,-2.7092699609758308],\"y\":[-1.084322748214279,-2.0963381619664796,-2.8324089230982086,-3.7296805068351819,-4.8657643531255133,-6.0169727610026147,-7.1972805842720176,-8.3949224552592323,-9.5961352155139483],\"text\":[\"muScales: -0.30103<br />value:  -1.084323<br />q: q = 5\",\"muScales: -0.60206<br />value:  -2.096338<br />q: q = 5\",\"muScales: -0.90309<br />value:  -2.832409<br />q: q = 5\",\"muScales: -1.20412<br />value:  -3.729681<br />q: q = 5\",\"muScales: -1.50515<br />value:  -4.865764<br />q: q = 5\",\"muScales: -1.80618<br />value:  -6.016973<br />q: q = 5\",\"muScales: -2.10721<br />value:  -7.197281<br />q: q = 5\",\"muScales: -2.40824<br />value:  -8.394922<br />q: q = 5\",\"muScales: -2.70927<br />value:  -9.596135<br />q: q = 5\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(34,168,132,1)\",\"opacity\":1,\"size\":11.338582677165356,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(34,168,132,1)\"}},\"hoveron\":\"points\",\"name\":\"q = 5\",\"legendgroup\":\"q = 5\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[-0.3010299956639812,-0.6020599913279624,-0.90308998699194354,-1.2041199826559248,-1.505149978319906,-1.8061799739838871,-2.1072099696478683,-2.4082399653118496,-2.7092699609758308],\"y\":[-2.2910925123232553,-4.3376491394099759,-5.7902736594847406,-7.5605917743090512,-10.049116336880843,-12.546889889137372,-15.205768786587468,-17.897107948407321,-20.598942689357781],\"text\":[\"muScales: -0.30103<br />value:  -2.291093<br />q: q = 10\",\"muScales: -0.60206<br />value:  -4.337649<br />q: q = 10\",\"muScales: -0.90309<br />value:  -5.790274<br />q: q = 10\",\"muScales: -1.20412<br />value:  -7.560592<br />q: q = 10\",\"muScales: -1.50515<br />value: -10.049116<br />q: q = 10\",\"muScales: -1.80618<br />value: -12.546890<br />q: q = 10\",\"muScales: -2.10721<br />value: -15.205769<br />q: q = 10\",\"muScales: -2.40824<br />value: -17.897108<br />q: q = 10\",\"muScales: -2.70927<br />value: -20.598943<br />q: q = 10\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(93,200,99,1)\",\"opacity\":1,\"size\":11.338582677165356,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(93,200,99,1)\"}},\"hoveron\":\"points\",\"name\":\"q = 10\",\"legendgroup\":\"q = 10\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[-0.3010299956639812,-0.6020599913279624,-0.90308998699194354,-1.2041199826559248,-1.505149978319906,-1.8061799739838871,-2.1072099696478683,-2.4082399653118496,-2.7092699609758308],\"y\":[-3.4526133722203314,-6.5141901796890185,-8.6910794814786421,-11.342926903860377,-15.12410647171148,-18.917892003091808,-23.078290399545917,-27.259088925079347,-31.460790395285727],\"text\":[\"muScales: -0.30103<br />value:  -3.452613<br />q: q = 15\",\"muScales: -0.60206<br />value:  -6.514190<br />q: q = 15\",\"muScales: -0.90309<br />value:  -8.691079<br />q: q = 15\",\"muScales: -1.20412<br />value: -11.342927<br />q: q = 15\",\"muScales: -1.50515<br />value: -15.124106<br />q: q = 15\",\"muScales: -1.80618<br />value: -18.917892<br />q: q = 15\",\"muScales: -2.10721<br />value: -23.078290<br />q: q = 15\",\"muScales: -2.40824<br />value: -27.259089<br />q: q = 15\",\"muScales: -2.70927<br />value: -31.460790<br />q: q = 15\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(187,223,39,1)\",\"opacity\":1,\"size\":11.338582677165356,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(187,223,39,1)\"}},\"hoveron\":\"points\",\"name\":\"q = 15\",\"legendgroup\":\"q = 15\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[-0.90308998699194354,-0.90308998699194354],\"y\":[-36.470904204719687,73.751599602827383],\"text\":\"xintercept: -0.90309\",\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,0,0,0.4)\",\"dash\":\"dash\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[-2.4082399653118496,-2.4082399653118496],\"y\":[-36.470904204719687,73.751599602827383],\"text\":\"xintercept: -2.40824\",\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,0,0,0.4)\",\"dash\":\"dash\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":35.925280199252796,\"r\":13.283520132835205,\"b\":74.387712743877131,\"l\":78.372768783727707},\"plot_bgcolor\":\"rgba(255,255,255,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":26.567040265670411},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-2.8296819592414235,-0.18061799739838871],\"tickmode\":\"array\",\"ticktext\":[\"-2\",\"-1\"],\"tickvals\":[-2,-1],\"categoryorder\":\"array\",\"categoryarray\":[\"-2\",\"-1\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":6.6417600664176026,\"tickwidth\":1.2075927393486547,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":21.253632212536321},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":1.2075927393486547,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"log(l)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":26.567040265670411}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-36.470904204719687,73.751599602827383],\"tickmode\":\"array\",\"ticktext\":[\"-25\",\"0\",\"25\",\"50\"],\"tickvals\":[-25,0,25,50],\"categoryorder\":\"array\",\"categoryarray\":[\"-25\",\"0\",\"25\",\"50\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":6.6417600664176026,\"tickwidth\":1.2075927393486547,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":21.253632212536321},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":1.2075927393486547,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"log(mu(q,l))\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":26.567040265670411}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":\"transparent\",\"line\":{\"color\":\"rgba(51,51,51,1)\",\"width\":1.9925280199252804,\"linetype\":\"solid\"},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":3.4359341445955631,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":21.253632212536321},\"title\":{\"text\":\"q\",\"font\":{\"color\":null,\"family\":null,\"size\":0}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"1315a598db052\":{\"x\":{},\"y\":{},\"colour\":{},\"type\":\"scatter\"},\"1315a6533056c\":{\"xintercept\":{}},\"1315a78a9295b\":{\"xintercept\":{}}},\"cur_data\":\"1315a598db052\",\"visdat\":{\"1315a598db052\":[\"function (y) \",\"x\"],\"1315a6533056c\":[\"function (y) \",\"x\"],\"1315a78a9295b\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n</div>\n```\n:::\n:::\n\n\n<p>\n\n<p>\n\nFigure 2: Partition function by (dyadic) scale - linearised by the logarithm method. The scales show show a linear progression in this plot. Any scales that do not exhibit such pattern should be removed in order to obtain accurate estimates. In this case the first, the second, and the ninth scales, indicated by the dashed lines.\n\n## Defining $q$ range {#defining-q-range}\n\nIt is also possible to define a family of dimensions $D_q$ for multifractal objects. The convergence of $D_q$ can provide clues on the range of $q$, as seen in figure 3.\n\n$$D_{q} = \\frac{1}{(q-1)}\\lim_{l \\rightarrow 0} \\frac{\\log\\sum_{i}P_{i}^{q}(l)}{\\log l}$$\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div align=\"center\">\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-7b49bf2c58360f8170c0\" style=\"width:100%;height:400px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-7b49bf2c58360f8170c0\">{\"x\":{\"data\":[{\"x\":[-50,-49,-48,-47,-46,-45,-44,-43,-42,-41,-40,-39,-38,-37,-36,-35,-34,-33,-32,-31,-30,-29,-28,-27,-26,-25,-24,-23,-22,-21,-20,-19,-18,-17,-16,-15,-14,-13,-12,-11,-10,-9,-8,-7,-6,-5,-4,-3,-2,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],\"y\":[1.6968903284451153,1.6962032011738331,1.6954873907739385,1.6947410449129645,1.6939621480655116,1.6931485032785734,1.6922977114667239,1.6914071478425143,1.6904739350143436,1.6894949121953826,1.6884665998591897,1.6873851590456117,1.6862463443583244,1.6850454494950273,1.6837772439026835,1.6824358988399339,1.6810149007394779,1.679506949271713,1.6779038368864494,1.6761963058109273,1.6743738774536785,1.6724246478289346,1.6703350408700934,1.6680895091972314,1.6656701688369486,1.6630563502705502,1.6602240425870927,1.6571451998261633,1.6537868679009577,1.6501100754273557,1.6460684102602432,1.6416061723087272,1.6366559471304958,1.6311353756023355,1.6249427889681547,1.6179512127706703,1.6099999779331768,1.6008827426254588,1.5903299981054084,1.5779828715290976,1.5633528063718694,1.54575764686034,1.524217145701763,1.4972769766909861,1.4627057748726775,1.4169783066734547,1.3545172545779134,1.2677047107602055,1.1559286477274646,1.0555201083237209,1,0.96812142410350843,0.94288794095908779,0.92060853518057584,0.90192075775675207,0.88721546758674386,0.87593333596574163,0.86722014275191828,0.86034652706898207,0.85479053674249283,0.85019825747760303,0.84633037234875474,0.84302190030295232,0.84015592940843697,0.83764717718670478,0.83543172345979877,0.83346049723430604,0.83169504522663151,0.83010470682928028,0.82866467484759365,0.82735462823545458,0.82615774407013465,0.82505996763188894,0.82404946258654121,0.82311618977947709,0.82225157980988728,0.82144827526964848,0.8206999255854377,0.82000102215336446,0.81934676472481915,0.81873295229819709,0.81815589341365802,0.81761233194298677,0.8170993853490659,0.81661449304999068,0.81615537302317887,0.81571998516789357,0.81530650024068008,0.81491327340903819,0.81453882165002012,0.81418180436391829,0.81384100668748904,0.81351532508269242,0.81320375485066743,0.81290537928036488,0.81261936018982661,0.81234492965779137,0.81208138277588648,0.81182807127849632,0.81158439792961168,0.81134981156437691],\"text\":[\"q: -50<br />Dq: 1.6968903\",\"q: -49<br />Dq: 1.6962032\",\"q: -48<br />Dq: 1.6954874\",\"q: -47<br />Dq: 1.6947410\",\"q: -46<br />Dq: 1.6939621\",\"q: -45<br />Dq: 1.6931485\",\"q: -44<br />Dq: 1.6922977\",\"q: -43<br />Dq: 1.6914071\",\"q: -42<br />Dq: 1.6904739\",\"q: -41<br />Dq: 1.6894949\",\"q: -40<br />Dq: 1.6884666\",\"q: -39<br />Dq: 1.6873852\",\"q: -38<br />Dq: 1.6862463\",\"q: -37<br />Dq: 1.6850454\",\"q: -36<br />Dq: 1.6837772\",\"q: -35<br />Dq: 1.6824359\",\"q: -34<br />Dq: 1.6810149\",\"q: -33<br />Dq: 1.6795069\",\"q: -32<br />Dq: 1.6779038\",\"q: -31<br />Dq: 1.6761963\",\"q: -30<br />Dq: 1.6743739\",\"q: -29<br />Dq: 1.6724246\",\"q: -28<br />Dq: 1.6703350\",\"q: -27<br />Dq: 1.6680895\",\"q: -26<br />Dq: 1.6656702\",\"q: -25<br />Dq: 1.6630564\",\"q: -24<br />Dq: 1.6602240\",\"q: -23<br />Dq: 1.6571452\",\"q: -22<br />Dq: 1.6537869\",\"q: -21<br />Dq: 1.6501101\",\"q: -20<br />Dq: 1.6460684\",\"q: -19<br />Dq: 1.6416062\",\"q: -18<br />Dq: 1.6366559\",\"q: -17<br />Dq: 1.6311354\",\"q: -16<br />Dq: 1.6249428\",\"q: -15<br />Dq: 1.6179512\",\"q: -14<br />Dq: 1.6100000\",\"q: -13<br />Dq: 1.6008827\",\"q: -12<br />Dq: 1.5903300\",\"q: -11<br />Dq: 1.5779829\",\"q: -10<br />Dq: 1.5633528\",\"q:  -9<br />Dq: 1.5457576\",\"q:  -8<br />Dq: 1.5242171\",\"q:  -7<br />Dq: 1.4972770\",\"q:  -6<br />Dq: 1.4627058\",\"q:  -5<br />Dq: 1.4169783\",\"q:  -4<br />Dq: 1.3545173\",\"q:  -3<br />Dq: 1.2677047\",\"q:  -2<br />Dq: 1.1559286\",\"q:  -1<br />Dq: 1.0555201\",\"q:   0<br />Dq: 1.0000000\",\"q:   1<br />Dq: 0.9681214\",\"q:   2<br />Dq: 0.9428879\",\"q:   3<br />Dq: 0.9206085\",\"q:   4<br />Dq: 0.9019208\",\"q:   5<br />Dq: 0.8872155\",\"q:   6<br />Dq: 0.8759333\",\"q:   7<br />Dq: 0.8672201\",\"q:   8<br />Dq: 0.8603465\",\"q:   9<br />Dq: 0.8547905\",\"q:  10<br />Dq: 0.8501983\",\"q:  11<br />Dq: 0.8463304\",\"q:  12<br />Dq: 0.8430219\",\"q:  13<br />Dq: 0.8401559\",\"q:  14<br />Dq: 0.8376472\",\"q:  15<br />Dq: 0.8354317\",\"q:  16<br />Dq: 0.8334605\",\"q:  17<br />Dq: 0.8316950\",\"q:  18<br />Dq: 0.8301047\",\"q:  19<br />Dq: 0.8286647\",\"q:  20<br />Dq: 0.8273546\",\"q:  21<br />Dq: 0.8261577\",\"q:  22<br />Dq: 0.8250600\",\"q:  23<br />Dq: 0.8240495\",\"q:  24<br />Dq: 0.8231162\",\"q:  25<br />Dq: 0.8222516\",\"q:  26<br />Dq: 0.8214483\",\"q:  27<br />Dq: 0.8206999\",\"q:  28<br />Dq: 0.8200010\",\"q:  29<br />Dq: 0.8193468\",\"q:  30<br />Dq: 0.8187330\",\"q:  31<br />Dq: 0.8181559\",\"q:  32<br />Dq: 0.8176123\",\"q:  33<br />Dq: 0.8170994\",\"q:  34<br />Dq: 0.8166145\",\"q:  35<br />Dq: 0.8161554\",\"q:  36<br />Dq: 0.8157200\",\"q:  37<br />Dq: 0.8153065\",\"q:  38<br />Dq: 0.8149133\",\"q:  39<br />Dq: 0.8145388\",\"q:  40<br />Dq: 0.8141818\",\"q:  41<br />Dq: 0.8138410\",\"q:  42<br />Dq: 0.8135153\",\"q:  43<br />Dq: 0.8132038\",\"q:  44<br />Dq: 0.8129054\",\"q:  45<br />Dq: 0.8126194\",\"q:  46<br />Dq: 0.8123449\",\"q:  47<br />Dq: 0.8120814\",\"q:  48<br />Dq: 0.8118281\",\"q:  49<br />Dq: 0.8115844\",\"q:  50<br />Dq: 0.8113498\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(29,145,192,1)\",\"opacity\":1,\"size\":11.338582677165356,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(29,145,192,1)\"}},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[-30,-30],\"y\":[0.76565548357774427,1.7412348448673711],\"text\":\"xintercept: -30\",\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,0,0,0.4)\",\"dash\":\"dash\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[30,30],\"y\":[0.76565548357774427,1.7412348448673711],\"text\":\"xintercept: 30\",\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,0,0,0.4)\",\"dash\":\"dash\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[-55,55],\"y\":[0.81000000000000005,0.81000000000000005],\"text\":\"yintercept: 0.81\",\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,0,0,0.4)\",\"dash\":\"dash\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[-55,55],\"y\":[1.6899999999999999,1.6899999999999999],\"text\":\"yintercept: 1.69\",\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,0,0,0.4)\",\"dash\":\"dash\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":35.925280199252796,\"r\":13.283520132835205,\"b\":74.387712743877131,\"l\":88.999584889995859},\"plot_bgcolor\":\"rgba(255,255,255,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":26.567040265670411},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-55,55],\"tickmode\":\"array\",\"ticktext\":[\"-50\",\"-25\",\"0\",\"25\",\"50\"],\"tickvals\":[-50,-25.000000000000004,0,25,50],\"categoryorder\":\"array\",\"categoryarray\":[\"-50\",\"-25\",\"0\",\"25\",\"50\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":6.6417600664176026,\"tickwidth\":1.2075927393486547,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":21.253632212536321},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":1.2075927393486547,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"q\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":26.567040265670411}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.76565548357774427,1.7412348448673711],\"tickmode\":\"array\",\"ticktext\":[\"1.00\",\"1.25\",\"1.50\"],\"tickvals\":[1,1.25,1.5],\"categoryorder\":\"array\",\"categoryarray\":[\"1.00\",\"1.25\",\"1.50\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":6.6417600664176026,\"tickwidth\":1.2075927393486547,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":21.253632212536321},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":1.2075927393486547,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"Dq\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":26.567040265670411}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":\"transparent\",\"line\":{\"color\":\"rgba(51,51,51,1)\",\"width\":1.9925280199252804,\"linetype\":\"solid\"},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":false,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":3.4359341445955631,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":21.253632212536321}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"1315ac9bcb23\":{\"x\":{},\"y\":{},\"type\":\"scatter\"},\"1315a48356d4c\":{\"xintercept\":{}},\"1315a2b9abd9d\":{\"xintercept\":{}},\"1315a3c16a4c8\":{\"yintercept\":{}},\"1315a729c6549\":{\"yintercept\":{}}},\"cur_data\":\"1315ac9bcb23\",\"visdat\":{\"1315ac9bcb23\":[\"function (y) \",\"x\"],\"1315a48356d4c\":[\"function (y) \",\"x\"],\"1315a2b9abd9d\":[\"function (y) \",\"x\"],\"1315a3c16a4c8\":[\"function (y) \",\"x\"],\"1315a729c6549\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n</div>\n```\n:::\n:::\n\n\n<p>\n\n<p>\n\nFigure 3: Example of generalised dimensions $D_q$ spectrum. A good practice when define the range of $q$ values is to check hoow long it takes for the $D_q$ values to converge. In this case around $q = 30$, as shown by the dashed lines.\n\n## Now you can perform your multifractal analyses\n\nThis was a quick guide on how to evaluate multifractal time series with the script presented at my [Github repository](https://github.com/lucasfr/chhabra-jensen). It is also recommended to add an extra protection against overffiting, if you are evaluating large amounts of data, by verifying the $R^2$, e.g. discarding values of $\\alpha$ and $f(\\alpha)$ which feature an $R^2 < 0.9$ --- or any other threshold you consider adequate according to your data.\n\n## References:\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"../../site_libs/plotly-binding-4.10.4/plotly.js\"></script>\n<script src=\"../../site_libs/typedarray-0.1/typedarray.min.js\"></script>\n<script src=\"../../site_libs/jquery-3.5.1/jquery.min.js\"></script>\n<link href=\"../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n<link href=\"../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}